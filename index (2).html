<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Herbalife Nutrition Coach AI</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #ff9a9e 0%, #fecfef 50%, #fecfef 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(255, 105, 180, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff69b4, #ff1493);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 40px;
        }

        .input-section, .output-section {
            background: #fff;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(255, 105, 180, 0.1);
            border: 2px solid #ffb6c1;
        }

        .input-section h2, .output-section h2 {
            color: #ff1493;
            font-size: 1.8em;
            margin-bottom: 20px;
            text-align: center;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #ff1493;
            font-weight: 600;
            margin-bottom: 8px;
            font-size: 1.1em;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #ffb6c1;
            border-radius: 10px;
            font-size: 1em;
            background: #fafafa;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .submit-btn {
            width: 100%;
            background: linear-gradient(135deg, #ff69b4, #ff1493);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            text-transform: uppercase;
        }

        .loading {
            display: none;
            text-align: center;
            color: #ff1493;
            font-size: 1.1em;
        }

        .loading i {
            font-size: 2em;
            animation: spin 2s linear infinite;
            margin-bottom: 10px;
            display: block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .response-content {
            background: #fef7f7;
            padding: 20px;
            border-radius: 10px;
            border-left: 5px solid #ff69b4;
            line-height: 1.6;
            max-height: 600px;
            overflow-y: auto;
        }

        .error-message {
            background: #ffe6e6;
            color: #d32f2f;
            padding: 15px;
            border-radius: 10px;
            border-left: 5px solid #d32f2f;
            margin: 20px 0;
        }

        .quick-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 182, 193, 0.1);
            border-radius: 15px;
        }

        .quick-btn {
            background: linear-gradient(135deg, #ffb6c1, #ffc0cb);
            color: #ff1493;
            padding: 15px 20px;
            border: none;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            text-align: center;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
                padding: 20px;
            }
            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-heartbeat"></i> Herbalife Nutrition Coach AI</h1>
            <p>Your Personal Wellness & Nutrition Assistant</p>
        </div>

        <div class="quick-actions">
            <button class="quick-btn" onclick="fillSampleClient()">
                <i class="fas fa-user"></i> Sample Client (220lb Engineer)
            </button>
            <button class="quick-btn" onclick="clearForm()">
                <i class="fas fa-refresh"></i> Clear Form
            </button>
        </div>

        <div class="main-content">
            <div class="input-section">
                <h2><i class="fas fa-clipboard-list"></i> Client Assessment</h2>
                <form id="nutritionForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="weight"><i class="fas fa-weight"></i> Weight</label>
                            <input type="number" id="weight" name="weight" required>
                        </div>
                        <div class="form-group">
                            <label for="weightUnit">Weight Unit</label>
                            <select id="weightUnit" name="weightUnit">
                                <option value="lbs">Pounds (lbs)</option>
                                <option value="kg">Kilograms (kg)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="height"><i class="fas fa-ruler-vertical"></i> Height</label>
                            <input type="number" id="height" name="height" required>
                        </div>
                        <div class="form-group">
                            <label for="heightUnit">Height Unit</label>
                            <select id="heightUnit" name="heightUnit">
                                <option value="in">Inches</option>
                                <option value="cm">Centimeters</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="age"><i class="fas fa-calendar-alt"></i> Age</label>
                            <input type="number" id="age" name="age" required>
                        </div>
                        <div class="form-group">
                            <label for="gender"><i class="fas fa-venus-mars"></i> Gender</label>
                            <select id="gender" name="gender" required>
                                <option value="">Select Gender</option>
                                <option value="male">Male</option>
                                <option value="female">Female</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="activityLevel"><i class="fas fa-running"></i> Activity Level</label>
                        <select id="activityLevel" name="activityLevel">
                            <option value="sedentary">Sedentary (Desk job, no exercise)</option>
                            <option value="lightly_active">Lightly Active (Light exercise 1-3 days/week)</option>
                            <option value="moderately_active">Moderately Active (Exercise 3-5 days/week)</option>
                            <option value="very_active">Very Active (Hard exercise 6-7 days/week)</option>
                        </select>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="goal"><i class="fas fa-target"></i> Primary Goal</label>
                            <select id="goal" name="goal">
                                <option value="weight_loss">Weight Loss</option>
                                <option value="muscle_gain">Muscle Gain</option>
                                <option value="maintenance">Maintenance</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="weightGoal"><i class="fas fa-bullseye"></i> Goal Weight</label>
                            <input type="number" id="weightGoal" name="weightGoal">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="currentDiet"><i class="fas fa-utensils"></i> Current Diet</label>
                        <textarea id="currentDiet" name="currentDiet" rows="3" placeholder="e.g., Mostly fast food, low energy"></textarea>
                    </div>

                    <button type="submit" class="submit-btn" id="submitBtn">
                        <i class="fas fa-magic"></i> Get My Herbalife Plan
                    </button>
                </form>
            </div>

            <div class="output-section">
                <h2><i class="fas fa-chart-line"></i> Your Personalized Results</h2>
                
                <div class="loading" id="loading">
                    <i class="fas fa-heart-pulse"></i>
                    <p>Creating your personalized nutrition plan...</p>
                </div>

                <div id="responseContainer" style="display: none;">
                    <div class="response-content" id="responseContent"></div>
                </div>

                <div id="placeholderContent">
                    <div style="text-align: center; color: #ff69b4; padding: 40px;">
                        <i class="fas fa-heart" style="font-size: 4em; margin-bottom: 20px; opacity: 0.3;"></i>
                        <p style="font-size: 1.2em; opacity: 0.7;">Fill out the form to get your personalized Herbalife nutrition plan!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simple OpenAI API call - no N8N needed
        const OPENAI_API_KEY = 'YOUR_OPENAI_API_KEY_HERE'; // Replace with your OpenAI API key
        
        document.getElementById('nutritionForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const loading = document.getElementById('loading');
            const responseContainer = document.getElementById('responseContainer');
            const placeholderContent = document.getElementById('placeholderContent');
            const responseContent = document.getElementById('responseContent');

            // Show loading
            submitBtn.disabled = true;
            loading.style.display = 'block';
            responseContainer.style.display = 'none';
            placeholderContent.style.display = 'none';

            // Get form data
            const formData = new FormData(this);
            const clientData = Object.fromEntries(formData.entries());

            // Create prompt
            const prompt = createPrompt(clientData);

            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [
                            {
                                role: 'system',
                                content: 'You are a professional Herbalife nutrition coach. Provide detailed, structured nutrition plans using only Herbalife products. Format with clear sections, bullet points, and specific numbers. Never include CSS, HTML, or styling code in your response.'
                            },
                            {
                                role: 'user',
                                content: prompt
                            }
                        ],
                        max_tokens: 3000,
                        temperature: 0.2
                    })
                });

                if (!response.ok) {
                    throw new Error(`API Error: ${response.status}`);
                }

                const result = await response.json();
                const content = result.choices[0].message.content;

                // Display clean content
                responseContent.innerHTML = formatResponse(content);
                responseContainer.style.display = 'block';
                loading.style.display = 'none';

            } catch (error) {
                console.error('Error:', error);
                responseContent.innerHTML = `
                    <div class="error-message">
                        <strong>Error:</strong> ${error.message}<br>
                        Please check your API key and try again.
                    </div>
                `;
                responseContainer.style.display = 'block';
                loading.style.display = 'none';
            } finally {
                submitBtn.disabled = false;
            }
        });

        function createPrompt(data) {
            return `Create a comprehensive Herbalife nutrition assessment for:

CLIENT PROFILE:
• Weight: ${data.weight} ${data.weightUnit}
• Height: ${data.height} ${data.heightUnit}  
• Age: ${data.age} years
• Gender: ${data.gender}
• Activity Level: ${data.activityLevel}
• Primary Goal: ${data.goal}
• Goal Weight: ${data.weightGoal} ${data.weightUnit}
• Current Diet: ${data.currentDiet}

PROVIDE:
1. BMR and TDEE calculations
2. Specific Herbalife product recommendations with dosages
3. Daily meal plan with Herbalife integration
4. 4-week transformation timeline
5. Herbalife shopping list

Format with clear sections and bullet points. Use only Herbalife products.`;
        }

        function formatResponse(content) {
            // Clean content - remove any CSS/HTML artifacts
            let cleaned = content
                .replace(/ff1493[^;]*;?/g, '')
                .replace(/font-weight[^;]*;?/g, '')
                .replace(/margin[^;]*;?/g, '')
                .replace(/padding[^;]*;?/g, '')
                .replace(/border[^;]*;?/g, '')
                .replace(/color[^;]*;?/g, '')
                .replace(/<[^>]*>/g, '')
                .replace(/\s+/g, ' ')
                .trim();

            // Format for display
            return cleaned
                .replace(/\*\*([^*]+)\*\*/g, '<strong style="color: #ff1493;">$1</strong>')
                .replace(/###\s*([^#\n]+)/g, '<h3 style="color: #ff1493; margin: 20px 0 10px 0;">$1</h3>')
                .replace(/##\s*([^#\n]+)/g, '<h2 style="color: #ff1493; margin: 25px 0 15px 0;">$1</h2>')
                .replace(/HERBALIFE/gi, '<span style="color: #ff1493; font-weight: bold;">HERBALIFE</span>')
                .replace(/\n\n/g, '<br><br>')
                .replace(/\n/g, '<br>')
                .replace(/•\s*/g, '• ');
        }

        function fillSampleClient() {
            document.getElementById('weight').value = '220';
            document.getElementById('height').value = '68';
            document.getElementById('age').value = '32';
            document.getElementById('gender').value = 'male';
            document.getElementById('activityLevel').value = 'sedentary';
            document.getElementById('goal').value = 'weight_loss';
            document.getElementById('weightGoal').value = '200';
            document.getElementById('currentDiet').value = 'Mostly fast food, very tired, low energy';
        }

        function clearForm() {
            document.getElementById('nutritionForm').reset();
            document.getElementById('responseContainer').style.display = 'none';
            document.getElementById('placeholderContent').style.display = 'block';
        }
    </script>
</body>
</html>